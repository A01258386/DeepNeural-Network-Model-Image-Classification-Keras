import numpy as np
import tensorflow as tf
from tensorflow.keras import Input
from tensorflow.keras.models import Sequential
from tensorflow.keras.layers import Dense
from tensorflow.keras.optimizers import SGD
from tensorflow.keras.datasets import mnist

# load MNIST dataset
(X_train, y_train), (X_test, y_test) = mnist.load_data()

# Training set: 60,000 samples; each sample is a 28x28 grayscale image
# Test set:     10,000 samples; each sample is a 28x28 grayscale image
print('X_train.shape:', X_train.shape)
print('X_test.shape:', X_test.shape)

# flatten the images in X_train and X_test such that each sample becomes a row vector
X_train = X_train.reshape(60000, 784)
X_test = X_test.reshape(10000, 784)


print('X_train.shape:', X_train.shape)
print('X_test.shape:', X_test.shape)

# convert the pixel values from integer to float32 and 
X_train = X_train.astype('float32')
X_test = X_test.astype('float32')

